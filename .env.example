# Cyber Threat Intelligence Dashboard - Environment Variables
# Copy this file to .env and fill in your actual values

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# MongoDB connection string
MONGODB_URI=mongodb://localhost:27017/ctidb

# For Docker deployment with authentication:
# MONGODB_URI=mongodb://cti_admin:cti_secure_password@mongodb:27017/ctidb?authSource=admin

# =============================================================================
# API KEYS (Required for data ingestion)
# =============================================================================
# VirusTotal API Key - Get from https://www.virustotal.com/
# Free tier: 4 requests/minute, 500 requests/day
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here

# AbuseIPDB API Key - Get from https://www.abuseipdb.com/
# Free tier: 1000 requests/day
ABUSEIPDB_API_KEY=your_abuseipdb_api_key_here

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Flask environment (development, production, testing)
FLASK_ENV=production

# Secret key for session management and security
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your-super-secret-key-change-in-production-min-32-chars

# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# API rate limiting (requests per minute per IP)
RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# SCHEDULER CONFIGURATION
# =============================================================================
# Data fetch interval in minutes (recommended: 30-60)
FETCH_INTERVAL_MINUTES=30

# Maximum retry attempts for failed API requests
MAX_RETRY_ATTEMPTS=3

# Delay between retry attempts in seconds
RETRY_DELAY_SECONDS=60

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log file path (relative to application directory)
LOG_FILE=logs/cti_dashboard.log

# Enable structured logging (JSON format)
STRUCTURED_LOGGING=false

# =============================================================================
# DATA RETENTION AND CLEANUP
# =============================================================================
# Number of days to retain IOC data before cleanup
IOC_RETENTION_DAYS=365

# Enable automatic data cleanup
ENABLE_DATA_CLEANUP=true

# Cleanup interval in hours (how often to check for old data)
CLEANUP_INTERVAL_HOURS=24

# =============================================================================
# PERFORMANCE AND CACHING
# =============================================================================
# Cache timeout for API responses in minutes
CACHE_TIMEOUT_MINUTES=15

# Enable Redis caching (requires Redis server)
ENABLE_REDIS_CACHE=false

# Redis connection string (if enabled)
REDIS_URL=redis://localhost:6379/0

# Maximum concurrent API requests
MAX_CONCURRENT_REQUESTS=10

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Enable HTTPS only (redirect HTTP to HTTPS)
HTTPS_ONLY=false

# SSL certificate path (if using HTTPS)
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem

# SSL private key path (if using HTTPS)
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# Enable API key authentication (optional)
ENABLE_API_KEY_AUTH=false

# Master API key for protected endpoints
MASTER_API_KEY=your-master-api-key-if-enabled

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Enable email notifications for alerts
ENABLE_EMAIL_NOTIFICATIONS=false

# SMTP server configuration
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_USE_TLS=true

# Notification recipient emails (comma-separated)
NOTIFICATION_EMAILS=admin@example.com,analyst@example.com

# =============================================================================
# MONITORING AND METRICS
# =============================================================================
# Enable Prometheus metrics endpoint
ENABLE_METRICS=false

# Metrics endpoint path
METRICS_PATH=/metrics

# Enable health check endpoint
ENABLE_HEALTH_CHECK=true

# Health check endpoint path
HEALTH_CHECK_PATH=/api/health

# =============================================================================
# INTEGRATION CONFIGURATION
# =============================================================================
# MISP integration (optional)
ENABLE_MISP_INTEGRATION=false
MISP_URL=https://your-misp-instance.com
MISP_API_KEY=your-misp-api-key

# TheHive integration (optional)
ENABLE_THEHIVE_INTEGRATION=false
THEHIVE_URL=https://your-thehive-instance.com
THEHIVE_API_KEY=your-thehive-api-key

# Splunk integration (optional)
ENABLE_SPLUNK_INTEGRATION=false
SPLUNK_URL=https://your-splunk-instance.com
SPLUNK_TOKEN=your-splunk-hec-token
SPLUNK_INDEX=threat_intelligence

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================
# Enable debug mode (only for development!)
DEBUG=false

# Enable auto-reload for development
AUTO_RELOAD=false

# Test data generation (development only)
GENERATE_TEST_DATA=false

# Mock API responses (development only)
MOCK_API_RESPONSES=false

# =============================================================================
# DOCKER DEPLOYMENT
# =============================================================================
# Docker network name
DOCKER_NETWORK=cti-network

# Container prefix for naming
CONTAINER_PREFIX=cti

# Resource limits (optional)
# MAX_MEMORY_USAGE=2g
# MAX_CPU_USAGE=2
